C51 COMPILER V9.52.0.0   TIMER                                                             10/28/2016 14:46:37 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN .\timer.obj
COMPILER INVOKED BY: C:\Program Files\kile\C51\BIN\C51.EXE ..\SRC\timer.c OMF2 OPTIMIZE(8,SPEED) BROWSE INCDIR(..\INC;..
                    -\PRO;..\SRC) DEBUG PRINT(.\timer.lst) TABS(2) OBJECT(.\timer.obj)

line level    source

   1           #include "include.h"
   2          
   3          //////////////////////////////////////////////////////////////////////////////////
   4          //// ¹¦ÄÜÃèÊö : ¶¨Ê±Æ÷0³õÊ¼»¯
   5          //// ÊäÈë²ÎÊý : 
   6          //// ·µ»Ø²ÎÊý : 
   7          //// ËµÃ÷     :  
   8          //////////////////////////////////////////////////////////////////////////////////
   9          void Timer0_Init (void)      // 30us
  10          {
  11   1        TR0 = 1;          //Timer0Æô¶¯,¼´TCON=0x10;
  12   1        ET0 = 1;          //T0Òç³öÖÐ¶ÏÔÊÐí
  13   1        TH0 = (255-10);   //10US 
  14   1        TMOD = 2;         //¶¨Ê±Æ÷0 8bit×Ô¶¯ÖØ×°ÔØ
  15   1        CKCON |= 0x01;    //4·ÖÆµÂÊ  6/4
  16   1        EA =0;
  17   1      }
  18          //////////////////////////////////////////////////////////////////////////////////
  19          //// ¹¦ÄÜÃèÊö : ¶¨Ê±Æ÷0ÖÐ¶ÏÈë¿Úº¯Êý
  20          //// ÊäÈë²ÎÊý : 
  21          //// ·µ»Ø²ÎÊý : 
  22          //// ËµÃ÷     :  1ms²É¼¯Ò»´Î Á¬Ðø²ÉÑù20´Ë´óÓÚ»ù×¼µçÑ¹£¬±íÊ¾ÓÐ´¥·¢
  23          //////////////////////////////////////////////////////////////////////////////////
  24          void Timer0(void) interrupt 1         //10us
  25          {
  26   1        count++;                            //¶Ô10us¼ÆÊý        
  27   1      
  28   1        if(LedDelayCnt>0)                   //°´¼ü¹Ø¶Ï¼ÆÊ±
  29   1           LedDelayCnt--;
  30   1        
  31   1        if(count>FSLEDONTIME)                 //³ÖÐø·¢Éä
  32   1        { 
  33   2            if(basecount<BASE_AD_COUNT)
  34   2               basecount++;
  35   2            count=0;
  36   2            pEMILEDCTL = ON;                  // ·¢Éä¹Ü´ò¿ª
  37   2            
  38   2      //      count++;
  39   2      //      count--;
  40   2          
  41   2      
  42   2            sampDat = ADC_Samp();             // ²É¼¯¸ß¶ËÊý¾Ý 
  43   2            f_prossout = TRUE;                //·¢ÉäÒ»´ÎÍê³É
  44   2          
  45   2      /*******ÒÔÏÂÊÇ»ù×¼²ÉÑù******************************************/   
  46   2            if(basecount <= BASE_AD_COUNT)
  47   2            {
  48   3              if((basecount%10) == 0)         // »ù×¼Öµ ²ÉÑù10´Î
  49   3              { 
  50   4                RevBase+=sampDat;
  51   4              }
  52   3            }
  53   2            if(basecount==BASE_AD_COUNT)      //È¡Æ½¾ùÖµ
  54   2            {
C51 COMPILER V9.52.0.0   TIMER                                                             10/28/2016 14:46:37 PAGE 2   

  55   3              basecount=BASE_AD_COUNT+10;
  56   3              RevBase = RevBase/(BASE_AD_COUNT/10);
  57   3              AD_Base=OK;
  58   3            }
  59   2      /*****************************************************************/   
  60   2          
  61   2          
  62   2          
  63   2      ///****Ã¿´Î¿ÕÏÐµÄÊ±ºò¶¼½øÐÐ»ù×¼²ÉÑùÈ·±£ÔÚÉè±¸ÒÆ¶¯¹ý³ÌÖÐ»ù×¼·¢Éú±ä»¯***********************/   
  64   2      //      if((basecount>First_Base)&&(out<StardBase))                     //µÚÒ»´ÎÅÐ¶ÏÊÇ·ñ¿ÕÏÐ  
  65   2      //        AD_BaseOne=OK;
  66   2      //      else
  67   2      //        AD_BaseOne=NO_OK;
  68   2      //      
  69   2      //      if((basecount>Second_Base)&&(out<StardBase)&&(AD_BaseOne=OK))   //µÚ¶þ´ÎÈ·¶¨ÊÇ·ñ¿ÕÏÐ ÒÀÈ»¿ÕÏÐ£¬È·¶¨¿ÉÒ
             -Ô×÷Îª»ù×¼  ¿ªÊ¼ ±£´æ»ù×¼
  70   2      //      {
  71   2      //        basecount=0;
  72   2      //        RevBase=sampDat;
  73   2      //        AD_Base=OK;
  74   2      //      }
  75   2      //      if((basecount>Second_Base)&&(out>StardBase))                    //µ±µÚ¶þ´Î ²»ÔÙ¿ÕÏÐ£¬ÄÇÃ´ÇåÁãµÚÒ»´ÎµÄ
             -¿ÕÏÐ±êÖ¾        
  76   2      //        AD_BaseOne=NO_OK;
  77   2      ///***************************************************************************************/
  78   2             
  79   2        }
  80   1        else
  81   1        {
  82   2           pEMILEDCTL = OFF;                // ·¢Éä¹Ü¹Ø±Õ
  83   2        }
  84   1        }
  85          
  86          //////////////////////////////////////////////////////////////////////////////////
  87          //// ¹¦ÄÜÃèÊö : ¶¨Ê±Æ÷0¿ªÆô
  88          //// ÊäÈë²ÎÊý : 
  89          //// ·µ»Ø²ÎÊý : 
  90          //// ËµÃ÷     :  
  91          //////////////////////////////////////////////////////////////////////////////////
  92          void Interrupt_Init (void)
  93          {
  94   1        EA = 1; //ÖÐ¶ÏÔÊÐí×Ü¿ØÖÆÎ»
  95   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    225    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
